<!DOCTYPE HTML>

<html>

<head>

    <script type="text/javascript">
        function WebSocketTest() {

            if ("WebSocket" in window) {
                const documentlocation = (document.location.origin).slice(7, -4) + "8080/ws";
                alert(`WebSocket is supported by your Browser! ws://${documentlocation}`);

                //`wss://${(document.location.origin).slice(7, -5)}:8080`
                if ((document.location.origin).lastIndexOf("https") != -1) {
                    const url = `wss://${documentlocation}`;
                    startws(url)
                } else {
                    // Let us open a web socket
                    const url = `ws://${documentlocation}`;
                    startws(url)
                }

                function startws(url) {
                    const connection = new WebSocket(url)

                    connection.onopen = () => {
                        console.log('connected')
                        connection.send('hey')
                    }

                    connection.onerror = (error) => {
                        console.log(`WebSocket error: ${error}`)
                    }

                    connection.onmessage = (e) => {
                        console.log(e.data)
                    }
                }


            } else {

                // The browser doesn't support WebSocket
                alert("WebSocket NOT supported by your Browser!");
            }
        }
    </script>

</head>

<body>
    <div id="sse">
        <a href="javascript:WebSocketTest()">Run WebSocket</a>
    </div>

</body>

</html>